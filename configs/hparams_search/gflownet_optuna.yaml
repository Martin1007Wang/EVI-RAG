# @package _global_

# Optuna-based hyperparameter search for GFlowNet.
# Usage (example):
#   python src/train.py -m experiment=train_gflownet hparams_search=gflownet_optuna \
#     dataset=webqsp ckpt.retriever=/path/to/retriever.ckpt logger=none

defaults:
  - override /hydra/sweeper: optuna
  - override /hydra/sweeper/sampler: tpe

# Metric returned from src/train.py::main() via `get_metric_value(...)`.
optimized_metric: "val/answer_hit"

# Make sweeps practical: allow early stopping to trigger immediately.
trainer:
  min_epochs: 0
  check_val_every_n_epoch: 1

hydra:
  sweeper:
    study_name: gflownet_optuna
    sampler:
      seed: 42
    n_trials: 24
    n_jobs: 1
    direction: maximize
    params:
      # Semantic shaping strength in log-domain.
      model.reward_cfg.semantic_coef: choice(0.5, 1.0, 2.0, 5.0)
      # Optimizer LR (log-uniform).
      model.optimizer_cfg.lr: tag(log, interval(3e-5, 3e-4))
