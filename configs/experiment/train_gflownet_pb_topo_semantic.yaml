# @package _global_
#
# GFlowNet training: PB-topo-semantic (static backward policy).

defaults:
  - override /model/db: topo_semantic
  - override /callbacks: default
  - override /logger: wandb
  - override /trainer: gpu

task_name: "train/gflownet/pb_topo_semantic"
tags: ["dual_flow", "gflownet", "pb_topo_semantic"]
optimized_metric: "val/f1@beam"

trainer:
  check_val_every_n_epoch: 5
  precision: 32

model:
  scheduler_cfg:
    type: cosine
    t_max: 10
    eta_min: 1.0e-6
    interval: epoch

  training_cfg:
    accumulate_grad_batches: 4

callbacks:
  model_checkpoint:
    monitor: val/f1@beam
    mode: max
    filename: "epoch_{epoch:03d}"
    auto_insert_metric_name: False
    save_weights_only: True
  early_stopping:
    monitor: val/f1@beam
    mode: max
    patience: 50
