# @package _global_
#
# Experiment: export GFlowNet rollouts (stream JSONL, no metrics).

defaults:
  - override /data: g_retrieval
  - override /model: gflownet_module
  - override /callbacks: gflownet_rollout_artifact_writer
  - override /logger: none
  - override /trainer: predict

run:
  name: export_gflownet
  task_name: "export/gflownet"
  tags: ["export", "gflownet"]
  split: test
  ckpt_path: ${ckpt.gflownet}
  dataset_variants:
    - ${dataset.dataset_family}
    - ${dataset.dataset_family}-sub
  require_dual_datasets: true

ckpt:
  gflownet: ${oc.env:GFLOWNET_CKPT,null}

data:
  splits:
    test: ${run.split}

callbacks:
  gflownet_rollout_artifact_writer:
    output_dir: ${dataset.artifact_dir}/export_gflownet
    split: ${run.split}
    artifact_name: export_gflownet
    schema_version: 1
    textualize: true
    entity_vocab_path: ${dataset.out_dir}/entity_vocab.parquet
    relation_vocab_path: ${dataset.out_dir}/relation_vocab.parquet
    questions_path: ${dataset.out_dir}/questions.parquet
