# @package _global_
#
# Stage: Evaluate retriever (metrics + optional persisted cache for downstream oracle/LLM stages).

defaults:
  - override /data: retriever
  - override /model: retriever_module
  - override /callbacks: none
  - override /logger: none
  - override /trainer: predict

stage:
  name: retriever_eval
  task_name: "eval/retriever"
  tags: ["eval", "retriever"]
  run:
    return_predictions: false

ckpt_path: ${ckpt.retriever}

model:
  eval_persist_cfg:
    enabled: true
    output_dir: ${dataset.materialized_dir}/eval_retriever
    splits: ["test"]
    textualize: true
    entity_vocab_path: ${dataset.out_dir}/entity_vocab.parquet
    relation_vocab_path: ${dataset.out_dir}/relation_vocab.parquet
