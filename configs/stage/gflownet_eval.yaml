# @package _global_
#
# Stage: Evaluate GFlowNet on g_agent caches (metrics + persisted rollouts).

defaults:
  - override /data: gflownet
  - override /model: gflownet_local_gat
  - override /callbacks: none
  - override /logger: none
  - override /trainer: predict

stage:
  name: gflownet_eval
  task_name: "eval/gflownet"
  tags: ["eval", "gflownet"]
  run:
    return_predictions: false

ckpt_path: ${ckpt.gflownet}

debug: false

model:
  evaluation_cfg:
    # Evaluation windows (K rollouts) for answer_hit@K.
    num_eval_rollouts: [1, 5, 10, 25, 50]
    rollout_temperature: 1.0
  eval_persist_cfg:
    enabled: true
    stream: false
    splits: ["predict"]
    output_dir: ${dataset.materialized_dir}/eval_gflownet
  embedder_cfg:
    allow_deferred_init: true
