# @package _global_
#
# Stage: Evaluate GFlowNet on g_agent caches (metrics + optional persisted rollouts for LLM path prompting).

defaults:
  - override /data: gflownet
  - override /model: gflownet_module
  - override /callbacks: none
  - override /logger: none
  - override /trainer: predict

stage:
  name: gflownet_eval
  task_name: "eval/gflownet"
  tags: ["eval", "gflownet"]
  run:
    loop: test
    return_predictions: false

ckpt_path: ${ckpt.gflownet}

model:
  embedder_cfg:
    projector_checkpoint: ${ckpt.retriever}
  eval_persist_cfg:
    enabled: true
    output_dir: ${dataset.materialized_dir}/eval_gflownet
    splits: ["test"]
    textualize: true
    entity_vocab_path: ${dataset.out_dir}/entity_vocab.parquet
    relation_vocab_path: ${dataset.out_dir}/relation_vocab.parquet
