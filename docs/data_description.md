# EVI-RAG 项目检索数据集 (G_retrieval) 统计分析报告

**日期：** 2024-11-26
**数据源：** WebQSP / ComplexWebQuestions (CWQ) 原始 Parquet 文件
**分析对象：** 局部检索图 (Query-Specific Local Graphs)

---

## 1. 概述

本报告旨在客观展示 `G_retrieval` 阶段局部子图的数据分布特征。统计范围覆盖 WebQSP 与 CWQ 两个数据集的 Train/Validation/Test 全量数据。分析维度包括图规模、实体召回率、连通性、路径跳数分布及拓扑特征。

## 2. 数据集详细统计

### 2.1 WebQSP 数据集

WebQSP 表现出极高的连通性和较浅的推理路径分布。

| 统计指标 | Train (训练集) | Validation (验证集) | Test (测试集) |
| :--- | :--- | :--- | :--- |
| **样本量** | 2,826 | 246 | 1,628 |
| **平均节点数** | 1,366 | 1,369 | 1,389 |
| **平均边数** | 4,229 | 4,142 | 4,309 |
| **Q实体 命中率** | 100.00% | 100.00% | 100.00% |
| **A实体 命中率** | 50.01% | 46.44% | 57.16% |
| **图连通性 (Connectivity)** | **96.07%** | 95.53% | 95.64% |
| **信噪比 (Median SNR)** | 0.0275% | 0.0271% | 0.0263% |

### 2.2 ComplexWebQuestions (CWQ) 数据集

CWQ 数据集作为多跳推理基准，其连通性较 WebQSP 下降约 15个百分点，且 2-hop 路径比例显著增加。

| 统计指标 | Train (训练集) | Validation (验证集) | Test (测试集) |
| :--- | :--- | :--- | :--- |
| **样本量** | 27,639 | 3,519 | 3,531 |
| **平均节点数** | 1,253 | 1,284 | 1,281 |
| **平均边数** | 3,948 | 4,142 | 4,273 |
| **Q实体 命中率** | 99.77% | 99.85% | 99.82% |
| **A实体 命中率** | 69.10% | 67.26% | 71.43% |
| **图连通性 (Connectivity)** | **79.92%** | 80.93% | 80.66% |
| **信噪比 (Median SNR)** | 0.0288% | 0.0265% | 0.0265% |

---

## 3. 核心维度对比分析

### 3.1 真实推理路径跳数分布 (Ground Truth Hop Distribution)

该指标统计了在图连通的样本中，从问题实体到答案实体的最短路径长度。

| 数据集 | 1-Hop (直接邻居) | 2-Hop (两步推理) | >= 3-Hop | 平均跳数 |
| :--- | :--- | :--- | :--- | :--- |
| **WebQSP** | **69.36%** | 29.91% | 0.00% | 1.29 |
| **CWQ** | 55.21% | **42.87%** | 0.00% | 1.41 |

*注：在当前的 PPR 建图策略下，所有连通样本的答案均分布在 2-hop 视野内，3-hop 及以上路径未被召回或不存在。*

### 3.2 图拓扑与复杂度 (Topology & Complexity)

该指标反映了在局部图中进行随机游走或无先验搜索的难度。

| 指标项 | WebQSP (Avg) | CWQ (Avg) | 说明 |
| :--- | :--- | :--- | :--- |
| **平均度数** | ~4.0 | ~4.0 | 图整体较为稀疏。 |
| **Hub 节点最大度数** | **~556** | **~573** | 存在度数极高的中心节点（超级节点）。 |
| **P90 度数** | ~7.0 | ~6.5 | 90% 的节点度数较小，复杂度集中在少数 Hub 节点。 |

### 3.3 信噪比 (Signal-to-Noise Ratio, SNR)

SNR 定义为 `最短路径边数 / 图总边数`。该指标量化了在无辅助信息情况下，随机选择到正确推理路径的概率基线。

| 数据集 | Mean SNR (平均值) | Median SNR (中位数) |
| :--- | :--- | :--- |
| **WebQSP** | 0.058% | **0.027%** |
| **CWQ** | 0.082% | **0.028%** |

---

## 4. 结论与工程约束摘要

基于上述数据统计，客观现状如下：

1.  **稀疏信号 (Sparse Signal):**
    两个数据集的中位数信噪比（Median SNR）均稳定在 **0.027%** 左右。这意味着在约 4000 条边的搜索空间中，通常仅有 1-2 条边属于有效推理路径。

2.  **有限视界 (Bounded Horizon):**
    在当前的数据构建方式下，**99% 以上**的有效推理路径位于 **2-hop** 范围内。数据集中不存在需要 3 步及以上推理的长程路径样本。

3.  **Hub 节点风险 (Hub Node Risk):**
    所有子图中均存在度数超过 550 的超级节点。若在推理过程中经过此类节点，动作空间（Action Space）将瞬间扩大，导致熵急剧增加。

4.  **连通性上限 (Connectivity Ceiling):**
    *   WebQSP 的理论可达上限为 96%。
    *   CWQ 的理论可达上限为 80%。这表明在 CWQ 中，约 **20%** 的样本在当前的局部图中物理不可达（存在断路），这是数据本身的固有属性。